<?xml version="1.0" encoding="UTF-8"?>
<vxml version="2.0" xmlns="http://www.w3.org/2001/vxml" xml:lang="fr-FR">

  <!-- FORM 1 : saisie département -->
  <form id="dept_form">
    <block>
      <prompt bargein="true">
        Bienvenue. Deux chiffres pour la metropole, trois pour l outre mer.
      </prompt>
    </block>

    <field name="dept">
      <prompt bargein="true">Tapez maintenant le numero du departement.</prompt>
      <grammar mode="dtmf" src="builtin:dtmf/digits?minlength=2;maxlength=3"/>
      <noinput><prompt>Je n ai rien entendu. Reessayez.</prompt><reprompt/></noinput>
      <nomatch><prompt>Entree invalide. Reessayez.</prompt><reprompt/></nomatch>

      <filled>
        <!-- Normalisation Corse -->
        <if cond="dept == '201'">
          <assign name="dept" expr="'2A'"/>
        <elseif cond="dept == '202'"/>
          <assign name="dept" expr="'2B'"/>
        </if>

        <!-- Annonce ICI dans le filled (évite le cut) -->
        <prompt bargein="true">
          <if cond="dept == '75'">
            Vous etes rattache au Comite de Paris.
          <elseif cond="dept == '971'"/>
            Vous etes rattache au Comite de Guadeloupe.
          <else/>
            Vous etes rattache au Comite du departement <value expr="dept"/>.
          </if>
        </prompt>

        <!-- On passe explicitement au form suivant -->
        <goto next="#menu_form"/>
      </filled>
    </field>
  </form>

  <!-- FORM 2 : petit menu -->
  <form id="menu_form">
    <field name="menu">
      <prompt bargein="true">
        Menu principal. Tapez 1 Activites, 2 Aides techniques, 3 Eole,
        9 changer de departement, 0 quitter.
      </prompt>
      <grammar mode="dtmf" src="builtin:dtmf/digits?length=1"/>
      <noinput><prompt>Pas d entree.</prompt><reprompt/></noinput>
      <nomatch><prompt>Choix invalide.</prompt><reprompt/></nomatch>

      <filled>
        <if cond="menu == '1'">
          <prompt bargein="true">Activites et ateliers.</prompt>
          <reprompt/>
        <elseif cond="menu == '2'"/>
          <prompt bargein="true">Aides techniques.</prompt>
          <reprompt/>
        <elseif cond="menu == '3'"/>
          <prompt bargein="true">Bibliotheque Eole.</prompt>
          <reprompt/>
        <elseif cond="menu == '9'"/>
          <clear namelist="dept menu"/>
          <goto next="#dept_form"/>
        <elseif cond="menu == '0'"/>
          <prompt bargein="true">Merci pour votre appel. Au revoir.</prompt>
          <disconnect/>
        <else/>
          <prompt>Choix non gere. Retour menu.</prompt>
          <reprompt/>
        </if>
      </filled>
    </field>
  </form>

</vxml>
